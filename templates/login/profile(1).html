{% extends 'base.html' %}
{% load static %}
{% block title %} My Profile {% endblock %}

{% block head %}

<title>User Login</title>

{% endblock %}

{% block body %}


<!-- Profile 1 - Bootstrap Brain Component -->
<section class="bg-light py-3 py-md-5 py-xl-8">
  <div class="container">
    <div class="row justify-content-md-center">
      <div class="col-12 col-md-10 col-lg-8 col-xl-7 col-xxl-6">
        <h5 class="welcome-to">Welcome To</h5>
        <h2 class="mb-4 display-5 text-center">{{profile.full_name}}' Dashboard</h2>
        <p class="text-secondary text-center lead fs-4 mb-3">hi {{profile.full_name}}, welcome to your dashboard. </p>
        <div class="create-map">
          <a class="btn create-map-btn" href="{% url 'Map:create_map' %}" type="button">Create New Map</a>
        </div>
        <hr class="w-50 mx-auto mb-5 mb-xl-9 border-dark-subtle">
        {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row gy-4 gy-lg-0">
      <div class="col-12 col-lg-4 col-xl-3">
        <div class="row gy-4">
          <div class="col-12">
            <div class="card widget-card border-light shadow-sm">
              <div class="card-header card-title">{{ profile.full_name }}'s Informations</div>
              <div class="card-body">
                <div class="text-center mb-3">
                  <img src="{{ profile.profile_picture.url }}" class="rounded-circle profile-img" alt="Luna John">
                </div>
                <h5 class="text-center mb-1">{{ profile.full_name }}</h5>
                <p class="text-center text-secondary mb-4">{{ profile.user_status}}</p>
                <ul class="list-group list-group-flush mb-4">
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <h6 class="m-0">Email:</h6>
                    <span>{{profile.email}}</span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <h6 class="m-0">Phone:</h6>
                    <span>{{profile.phone}}</span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center">
                    <h6 class="m-0">Address:</h6>
                    <span>{{profile.address}}</span>
                  </li>
                </ul>
                <div class="d-grid m-0">
                  <a class="btn btn-outline-primary profile-edit-btn" href="{% url 'Login:edit_profile' profile.user.username %}" type="button">Edit Profile</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="card widget-card border-light shadow-sm">
              <div class="card-header card-title">Map Status</div>
              <div class="card-body">
                <span class="badge status-badge">Published ({{published_count}})</span>
                <span class="badge status-badge">Pending ({{pending_count}})</span>
                <span class="badge status-badge">Reject ({{reject_count}})</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12 col-lg-8 col-xl-9">
        <div class="card widget-card border-light shadow-sm">
          <div class="card-body p-4">
            <ul class="nav nav-tabs" id="profileTab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="published-tab" data-bs-toggle="tab" data-bs-target="#published-tab-pane" type="button" role="tab" aria-controls="published-tab-pane" aria-selected="true">Published</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending-tab-pane" type="button" role="tab" aria-controls="pending-tab-pane" aria-selected="false">Pending</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="reject-tab" data-bs-toggle="tab" data-bs-target="#reject-tab-pane" type="button" role="tab" aria-controls="reject-tab-pane" aria-selected="false">Reject</button>
              </li>
            </ul>
      
            <div id="map-list-container" class="p-4">
              <div class="map-list-div">
                {% for map in maps %}
                  <div class="card map-item" data-status="{{ map.status }}" style="width: 18rem;">
                    <a href="{% url 'Map:map_detail' map_id=map.id %}">
                      {% if map.thumbnail %}
                        <img class="card-img-top" src="{{ map.thumbnail.url }}" alt="Card image cap">
                      {% else %}
                        <img class="card-img-top" src="{% static 'Default-thum.png' %}" alt="Card image cap">
                      {% endif %}
                      <h5 class="card-title">{{ map.title }}</h5>
                      <p class="card-text">{{ map.description }}</p>
                      <div class="meta-container">
                        <div class="map-meta"><span class="material-symbols-outlined">person</span>{{ map.user.username }}</div>
                        <div class="map-meta"><span class="material-symbols-outlined">calendar_month</span>{{ map.publishing_date|date:"Y-m-d" }}</div>
                        <div class="map-meta"><span class="material-symbols-outlined">visibility</span>{{ map.views_count }}</div>
                      </div>
                      <a href="{% url 'Map:edit_map' map.id %}" class="btn edit-btn">Edit</a>
                    </a>
                  </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
  // Function to filter maps by status
  function filterMaps(status) {
    const mapItems = document.querySelectorAll('.map-item');
    mapItems.forEach(item => {
      if (item.getAttribute('data-status') === status) {
        item.style.display = 'block';
      } else {
        item.style.display = 'none';
      }
    });
  }

  // Default display: Show "published" maps
  filterMaps('published');

  // Add event listeners for tab clicks
  const tabs = document.querySelectorAll('.nav-link');
  tabs.forEach(tab => {
    tab.addEventListener('click', function () {
      const targetStatus = this.id.split('-')[0]; // Get status from id (e.g., "published", "pending", "reject")
      filterMaps(targetStatus);
    });
  });
});
</script>

<style>
  @media only screen and (max-width: 600px) {
    .card {
      width: 100%;
    }
  }
  
  .edit-btn {
      position: absolute;
      top: 5px;
      left: 5px;
      color: white;
      padding: 3px 8px;
      background-color: #007279;
      font-size: 12px;
  }
  
  .edit-btn:hover {
      color: white;
      background-color: #dc3545;
  }
  .map-list-div {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
  }
  
  
  .map-list-title {
      font-size: 2.0rem;
      text-align: center;
      color: white;
      background-color: #007279;
      margin-bottom: 25px;
      padding: 5px;
  
  }
  
  .row {
      --bs-gutter-x: 0;
  }
  
  .left-container {
      box-shadow: 3px 0px 5px rgba(0, 0, 0, 0.2);
      padding: 10px;
      z-index: 999;
  }
  
  /* map list  */
  div#map-list-container {
    display: flex;
    padding: 25px 5px 5px 5px !important;
}

  .map-meta {
      display: flex; align-items: center;
      color: #007279;
    }
    
    .meta-container {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      padding: 5px;
    }

    span.material-symbols-outlined {
        font-size: 18px;
    }
    
    .card-body {
        padding: 0.5rem;
        background-color: #d3d3d33b;
    }
  
    h5.card-title {
      color: #dc3545;
  }


/* ...................... */
.card-title {
  background-color: #007279; 
  color: white;
  text-align: center;
}

.profile-img{
  max-width: 150px;
  height: 150px;
  border: 1px solid #e3e3e3;
  padding: 3px;
}

.profile-edit-btn {
  border: 1px solid #007279;
  color: #dc3545;
}

.profile-edit-btn:hover {
  border: 1px solid #dc3545;
  background-color: #dc3545;
  color: white;
}
.welcome-to{
  margin-bottom: .5rem !important;
  text-align: center;
}

.status-badge {
  background-color: #dc3545;
  color: white;
}

.card-body .nav-link {
    color: #007279;
}


.create-map-btn {
  border-radius: 4px;
  background-color: #dc3545;
  border: none;
  color: #fff;
  text-align: center;
  font-size: 20px;
  width: 220px;
  transition: all 0.5s;
  cursor: pointer;
  box-shadow: 0 10px 20px -8px rgba(95, 95, 95, 0.7);
}

.create-map-btn{
  cursor: pointer;
  display: inline-block;
  position: relative;
  transition: 0.5s;
}

.create-map-btn:after {
  content: 'Â»';
  color: #ffff;
  position: absolute;
  opacity: 0;  
  top: 8px;
  right: -20px;
  transition: 0.5s;
}

.create-map-btn:hover{
  padding-right: 10px;
  padding-left:8px;
  background-color: #007279;
  color: #ffff;
}

.create-map-btn:hover:after {
  opacity: 1;
  right: 20px;
}

.create-map{
  text-align: center;
}
</style>



{% endblock %}



